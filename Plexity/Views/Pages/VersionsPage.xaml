<Page
    x:Class="Plexity.Views.Pages.VersionsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:Plexity.Views.Pages"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    Title="VersionsPage"
    d:DesignHeight="750"
    d:DesignWidth="800"
    ui:Design.Background="{DynamicResource ApplicationBackgroundBrush}"
    ui:Design.Foreground="{DynamicResource TextFillColorPrimaryBrush}"
    Foreground="{DynamicResource TextFillColorPrimaryBrush}"
    Loaded="Page_Loaded"
    ScrollViewer.CanContentScroll="False"
    mc:Ignorable="d">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Description -->
            <RowDefinition Height="Auto"/>
            <!-- Search & Count -->
            <RowDefinition Height="*"/>
            <!-- DataGrid -->
            <RowDefinition Height="Auto"/>
            <!-- Buttons -->
        </Grid.RowDefinitions>

        <!-- Description -->
        <TextBlock Grid.Row="0" Margin="-20,-20,0,0"
                   Text="Manage your Folders. Double click a column to edit."
                   FontSize="14"
                   TextWrapping="Wrap"/>

        <ui:InfoBar Grid.Row="0" Padding="8" Title="Use with caution." IsOpen="True"
                    Message="Renaming items updates their types automatically."
                    Severity="Warning" IsClosable="False" Height="45" Margin="-20,-35,-20,0"/>

        <!-- Search & Count -->
        <DockPanel Height="40" LastChildFill="True" Margin="-20,60,0,10">
            <ui:TextBox x:Name="SearchTextBox"
                        Width="650"
                        Height="32"
                        Margin="0,5,10,0"
                        Icon="Search48"
                        PlaceholderText="Search"
                        FontSize="14"
                        VerticalContentAlignment="Center"
                        BorderThickness="0"
                        TextChanged="SearchTextBox_TextChanged" />

            <TextBlock x:Name="TotalItemsTextBlock"
                       VerticalAlignment="Center"
                       FontSize="14"
                       Margin="0,16,0,0"
                       Foreground="#FFCACACA"
                       Text="Items count: 0"/>
        </DockPanel>

        <!-- DataGrid -->
        <DataGrid Grid.Row="2"
                  x:Name="VersionsDataGrid"
                  Margin="-20,-6,0,10"
                  AutoGenerateColumns="False"
                  HeadersVisibility="Column"
                  CanUserAddRows="False"
                  CanUserDeleteRows="False"
                  CanUserReorderColumns="True"
                  GridLinesVisibility="None"
                  RowHeight="20"
                  CellEditEnding="VersionsDataGrid_CellEditEnding"
                  Background="Transparent"
                  FontSize="14"
                  Foreground="White"
                  RowBackground="#232323"
                  AlternatingRowBackground="#232323"
                  HorizontalGridLinesBrush="#232323"
                  VerticalGridLinesBrush="#232323"
                  SelectionMode="Extended"
                  SelectionUnit="FullRow"
                  MaxHeight="400"
                  ScrollViewer.VerticalScrollBarVisibility="Auto"
                  ScrollViewer.HorizontalScrollBarVisibility="Auto">

            <!-- Header Style -->
            <DataGrid.ColumnHeaderStyle>
                <Style TargetType="DataGridColumnHeader">
                    <Setter Property="Background" Value="#2C2C2C"/>
                    <Setter Property="Foreground" Value="White"/>
                    <Setter Property="Padding" Value="10,0"/>
                    <Setter Property="Height" Value="32"/>
                    <Setter Property="BorderThickness" Value="0,0,0,1"/>
                    <Setter Property="BorderBrush" Value="#444"/>
                </Style>
            </DataGrid.ColumnHeaderStyle>

            <!-- Cell Style -->
            <DataGrid.CellStyle>
                <Style TargetType="DataGridCell">
                    <Setter Property="Padding" Value="5,0"/>
                    <Setter Property="Foreground" Value="White"/>
                    <Setter Property="Background" Value="Transparent"/>
                    <Setter Property="BorderThickness" Value="0"/>
                    <Setter Property="VerticalContentAlignment" Value="Center"/>
                    <Style.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="Background" Value="#3A3A3A"/>
                            <Setter Property="Foreground" Value="White"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </DataGrid.CellStyle>

            <!-- Editable Columns -->
            <DataGrid.Columns>
                <DataGridTextColumn Header="Name"
                                    Binding="{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                    Width="2*"/>
                <DataGridTextColumn Header="Type"
                                    Binding="{Binding Type, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                    Width="1*"
                                    IsReadOnly="True"/>
                <DataGridTextColumn Header="Size"
                                    Binding="{Binding Size, Mode=OneWay}"
                                    Width="1*"
                                    IsReadOnly="True"/>
            </DataGrid.Columns>
        </DataGrid>

        <!-- Buttons at the bottom -->
        <WrapPanel Grid.Row="3" HorizontalAlignment="Left" Margin="-20,0,0,0" ItemHeight="40" ItemWidth="Auto" Orientation="Horizontal" VerticalAlignment="Center">
            <ui:Button Width="100" Margin="0,0,10,0" Content="Add File" Icon="AddCircle24" Foreground="{DynamicResource TextFillColorPrimaryBrush}" Click="AddButton_Click"/>
            <ui:Button Width="120" Margin="0,0,10,0" Content="Delete Selected" Icon="SlideEraser24" Click="DeleteButton_Click"
                       Appearance="Danger"
                       Background="#ff3334" Foreground="{DynamicResource TextFillColorPrimaryBrush}">
                <ui:Button.PressedBackground>
                    <SolidColorBrush Opacity="0.7" Color="#ff5c5d" />
                </ui:Button.PressedBackground>
                <ui:Button.MouseOverBackground>
                    <SolidColorBrush Opacity="0.9" Color="#ff5c5d" />
                </ui:Button.MouseOverBackground>
                <ui:Button.Style>
                    <Style BasedOn="{StaticResource {x:Type ui:Button}}" TargetType="{x:Type ui:Button}">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding SelectedItems.Count, ElementName=VersionsDataGrid}" Value="0">
                                <Setter Property="IsEnabled" Value="False" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </ui:Button.Style>
            </ui:Button>
            <ui:Button Width="100" Margin="0,0,10,0" Foreground="{DynamicResource TextFillColorPrimaryBrush}" Content="Delete All" Icon="Delete48" Click="DeleteAllButton_Click"/>
            <ui:Button Width="100" Margin="0,0,10,0" Foreground="{DynamicResource TextFillColorPrimaryBrush}" Content="Refresh" Icon="Sync12" Click="RefreshButton_Click"/>
        </WrapPanel>
    </Grid>
</Page>
