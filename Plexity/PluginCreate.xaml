<Window x:Class="Plexity.PluginCreate"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Create Plugin"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        SizeToContent="WidthAndHeight"
        Foreground="{DynamicResource TextFillColorPrimaryBrush}">

    <Window.Resources>
        <Style TargetType="Hyperlink">
            <Setter Property="Foreground" Value="#CC378FFF" />
            <Setter Property="TextDecorations" Value="Underline" />
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Foreground" Value="#CC7FB7FF" />
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Border Background="#1E1E1E" Padding="20" Width="1000" Height="700">
        <DockPanel>

            <!-- Header -->
            <StackPanel DockPanel.Dock="Top" Margin="0,0,0,15">
                <TextBlock Text="Create New Plugin" FontSize="20" FontWeight="Bold" Foreground="White" />
                <StackPanel Orientation="Horizontal" Margin="0,10,0,0" VerticalAlignment="Center">
                    <TextBlock Text="Editor Mode:" VerticalAlignment="Center" Foreground="LightGray" Margin="0,0,10,0"/>
                    <ComboBox x:Name="EditorModeComboBox" Width="150">
                        <ComboBoxItem Content="XAML" IsSelected="True"/>
                        <ComboBoxItem Content="C#"/>
                    </ComboBox>
                </StackPanel>
            </StackPanel>

            <!-- Main Content -->
            <StackPanel DockPanel.Dock="Top" Margin="0,0,0,15">
                <TextBlock x:Name="CodeLabel" Text="Plugin XAML Code:" Foreground="LightGray" FontWeight="SemiBold" Margin="0,0,0,5"/>
                <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" Height="500">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="50"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Line Numbers -->
                        <TextBlock x:Name="LineNumbersTextBlock"
                                   FontFamily="Consolas"
                                   FontSize="14"
                                   Foreground="Gray"
                                   Margin="5,2,0,0"
                                   TextWrapping="NoWrap"
                                   VerticalAlignment="Top"/>

                        <!-- Code Editor + IntelliSense -->
                        <Grid Grid.Column="1">
                            <TextBox x:Name="CodeTextBox"
                                     AcceptsReturn="True"
                                     AcceptsTab="True"
                                     FontFamily="Consolas"
                                     FontSize="14"
                                     Background="#1E1E1E"
                                     Foreground="White"
                                     BorderBrush="#3C3C3C"
                                     BorderThickness="1"
                                     TextWrapping="NoWrap"
                                     VerticalScrollBarVisibility="Disabled"
                                     HorizontalScrollBarVisibility="Disabled"
                                     TextChanged="CodeTextBox_TextChanged"
                                     PreviewKeyDown="CodeTextBox_PreviewKeyDown"/>

               <Popup x:Name="SuggestionPopup"
                Placement="Absolute"
                StaysOpen="False"
                IsOpen="False"
                AllowsTransparency="True"
                PopupAnimation="Fade">
               <Border Background="Black" BorderBrush="Gray" BorderThickness="1">
                <ListBox x:Name="SuggestionList"
                 Foreground="White"
                 Background="#222"
                 BorderThickness="0"
                 FontFamily="Consolas"
                 MouseDoubleClick="SuggestionList_MouseDoubleClick"
                 PreviewKeyDown="SuggestionList_PreviewKeyDown"/>
                                </Border>
                            </Popup>
                        </Grid>
                    </Grid>
                </ScrollViewer>
            </StackPanel>

            <!-- Support Link -->
            <TextBlock FontSize="13"
                       Foreground="#CCFFFFFF"
                       Margin="0,0,0,16"
                       TextWrapping="Wrap">
                <Hyperlink NavigateUri="https://github.com/KloBraticc/PluginsPagePlexity/tree/main/Codes"
                           RequestNavigate="Hyperlink_RequestNavigate">
                    Want some Plugins code?
                </Hyperlink>
            </TextBlock>

            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" DockPanel.Dock="Bottom">
                <Button Content="Run Plugin" Width="120" Margin="0,0,10,0" Click="RunPlugin_Click"/>
                <Button Content="Save Plugin" Width="120" Margin="0,0,10,0" Click="SavePlugin_Click"/>
                <Button Content="Import" Width="120" Margin="0,0,10,0" Click="ImportPlugin_Click"/>
                <Button Content="Export" Width="120" Margin="0,0,10,0" Click="ExportPlugin_Click"/>
                <Button Content="Cancel" Width="100" Click="Cancel_Click"/>
            </StackPanel>

        </DockPanel>
    </Border>
</Window>
